import{r as a,j as e}from"./three-DBW-vNuJ.js";import{p as ie,r as X,a as Y,b as G,S as we,c as xe}from"./index-DDFsZ36w.js";import{g as i}from"./gsap-Brfk6Bdo.js";const ke=({sectionRef:$,prefersReducedMotion:v,project:m,titleWordRefs:B,descriptionRef:R,metaRowRefs:C,metaLinkRef:w,heroMediaRef:L,tileRefs:z,insightRefs:S,insightMediaRefs:j,resultsHeaderRef:T,metricRefs:I,testimonialRef:A,moreTitleRef:W,moreCardRefs:U})=>{a.useEffect(()=>{const N=$.current;if(!N||!m||v)return;const f=B.current.filter(Boolean),M=R.current,E=C.current.filter(Boolean),x=w.current,o=L.current,y=z.current.filter(Boolean),k=S.current.filter(Boolean),_=j.current.filter(Boolean),n=T.current,g=I.current.filter(Boolean),p=A.current,d=W.current,u=U.current.filter(Boolean),P=i.context(()=>{f.length&&i.set(f,{yPercent:120,rotateX:-80,autoAlpha:0,transformOrigin:"50% 100%"}),i.set([M,...E,x].filter(Boolean),{autoAlpha:0,y:18}),i.set([o,...y].filter(Boolean),{autoAlpha:0,y:30,scale:.96}),k.length&&i.set(k,{autoAlpha:0,y:24}),_.length&&i.set(_,{autoAlpha:0,y:24}),n&&i.set(n,{autoAlpha:0,y:22}),g.length&&i.set(g,{autoAlpha:0,y:16}),p&&i.set(p,{autoAlpha:0,y:20}),d&&i.set(d,{autoAlpha:0,y:20}),u.length&&i.set(u,{autoAlpha:0,y:24,scale:.98});const b=i.timeline();f.length&&b.to(f,{yPercent:0,rotateX:0,autoAlpha:1,duration:.9,ease:"power3.out",stagger:.06}),b.to(M,{autoAlpha:1,y:0,duration:.6,ease:"power2.out"},"-=0.45"),b.to(E,{autoAlpha:1,y:0,duration:.5,ease:"power2.out",stagger:.08},"-=0.4"),x&&b.to(x,{autoAlpha:1,y:0,duration:.5,ease:"power2.out"},"-=0.35"),o&&i.to(o,{autoAlpha:1,y:0,scale:1,duration:.8,ease:"power2.out",scrollTrigger:{trigger:o,start:"top 80%"}}),y.length&&i.to(y,{autoAlpha:1,y:0,scale:1,duration:.7,ease:"power2.out",stagger:.08,scrollTrigger:{trigger:y[0],start:"top 85%"}}),k.length&&i.to(k,{autoAlpha:1,y:0,duration:.7,ease:"power2.out",stagger:.18,scrollTrigger:{trigger:k[0],start:"top 82%"}}),_.length&&i.to(_,{autoAlpha:1,y:0,duration:.7,ease:"power2.out",scrollTrigger:{trigger:_[0],start:"top 85%"}}),n&&i.to(n,{autoAlpha:1,y:0,duration:.7,ease:"power2.out",scrollTrigger:{trigger:n,start:"top 85%"}}),g.length&&i.to(g,{autoAlpha:1,y:0,duration:.6,ease:"power2.out",stagger:.12,scrollTrigger:{trigger:g[0],start:"top 85%"}}),p&&i.to(p,{autoAlpha:1,y:0,duration:.7,ease:"power2.out",scrollTrigger:{trigger:p,start:"top 85%"}}),d&&i.to(d,{autoAlpha:1,y:0,duration:.6,ease:"power2.out",scrollTrigger:{trigger:d,start:"top 88%"}}),u.length&&i.to(u,{autoAlpha:1,y:0,scale:1,duration:.7,ease:"power2.out",stagger:.12,scrollTrigger:{trigger:u[0],start:"top 85%"}}),we.refresh()},N);return()=>P.revert()},[v,m==null?void 0:m.id])},be=({id:$})=>{var se,re;const v=a.useRef(null),m=a.useRef(null),B=a.useRef(null),R=a.useRef([]),C=a.useRef(null),w=a.useRef([]),L=a.useRef(null),z=a.useRef(null),S=a.useRef([]),j=a.useRef([]),T=a.useRef([]),I=a.useRef(null),A=a.useRef([]),W=a.useRef(null),U=a.useRef(null),N=a.useRef([]),[f,M]=a.useState(!1),[E,x]=a.useState(0),[o,y]=a.useState(0),[k,_]=a.useState(!1),n=a.useRef(null),g=a.useRef(0),[p,d]=a.useState(!1),u=a.useMemo(()=>typeof window>"u"||!window.matchMedia?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),P=a.useMemo(()=>typeof navigator>"u"?!1:!!(navigator.connection&&navigator.connection.saveData),[]),b=!u&&!P,le=!u,oe=p?P?"none":"metadata":"none";a.useEffect(()=>{xe()},[]);const s=ie.find(t=>t.id===$),D=s==null?void 0:s.challenges,F=s==null?void 0:s.solutions,O=s==null?void 0:s.solutionVideo,ne=s==null?void 0:s.solutionPoster,ce=D?1:0,J=!!(O&&!u&&!P);a.useEffect(()=>{if(!J){d(!1);return}const t=B.current;if(!t||typeof IntersectionObserver>"u"){d(!0);return}const r=new IntersectionObserver(c=>{var ae;(ae=c[0])!=null&&ae.isIntersecting&&(d(!0),r.disconnect())},{rootMargin:"200px"});return r.observe(t),()=>{r.disconnect()}},[J]),R.current=[],w.current=[],S.current=[],j.current=[],T.current=[],A.current=[],N.current=[],ke({sectionRef:v,prefersReducedMotion:u,project:s,titleWordRefs:R,descriptionRef:C,metaRowRefs:w,metaLinkRef:L,heroMediaRef:z,tileRefs:S,insightRefs:j,insightMediaRefs:T,resultsHeaderRef:I,metricRefs:A,testimonialRef:W,moreTitleRef:U,moreCardRefs:N});const de=()=>{const t=m.current;if(t)if(t.paused){const r=t.play();r&&typeof r.catch=="function"&&r.catch(()=>{})}else t.pause()},ue=t=>{const r=t.currentTarget;y(r.duration||0),x(r.currentTime||0)},me=t=>{k||(g.current=t.currentTarget.currentTime||0,!n.current&&(n.current=window.requestAnimationFrame(()=>{n.current=null,x(g.current)})))},q=()=>{_(!0)},V=()=>{_(!1)},he=t=>{const r=Number(t.target.value);Number.isNaN(r)||(x(r),m.current&&(m.current.currentTime=r))},K=t=>{if(!Number.isFinite(t))return"0:00";const r=Math.floor(t/60),c=Math.floor(t%60);return`${r}:${String(c).padStart(2,"0")}`};if(a.useEffect(()=>()=>{n.current&&window.cancelAnimationFrame(n.current)},[]),!s)return e.jsx("section",{className:"work-detail",ref:v,children:e.jsxs("div",{className:"work-detail__inner px-32 lg:px-48",children:[e.jsx("p",{className:"work-detail__eyebrow",children:"Work not found"}),e.jsx("h1",{className:"work-detail__title",children:"Project missing"}),e.jsx("p",{className:"work-detail__description",children:"The project you are looking for does not exist yet."}),e.jsx("a",{className:"work-detail__back",href:X("#latest-work"),children:"Back to latest work"})]})});const fe=(se=s.services)==null?void 0:se.join(" / "),_e=s.description||s.subtitle,Q=s.title.split(" "),h=s.results,Z=(h==null?void 0:h.metrics)||[],l=h==null?void 0:h.client,ge=l!=null&&l.name?l.name.split(" ").map(t=>t[0]).join("").slice(0,2).toUpperCase():"",ee=ie.filter(t=>t.id!==$).slice(0,2),H=o?Math.min(E,o):0,pe=o?H/o*100:0,te=Y(G(s.image),s.image);return e.jsx("section",{className:"work-detail",ref:v,children:e.jsxs("div",{className:"work-detail__inner px-32 lg:px-48",children:[e.jsxs("div",{className:"work-detail__hero",children:[e.jsxs("div",{className:"work-detail__copy",children:[e.jsx("h1",{className:"work-detail__title",children:Q.map((t,r)=>e.jsxs("span",{className:"work-detail__title-word",children:[e.jsx("span",{className:"work-detail__title-word-inner",ref:c=>{R.current[r]=c},children:t}),r<Q.length-1?" ":""]},`${s.id}-word-${r}`))}),e.jsx("p",{className:"work-detail__description",ref:C,children:_e})]}),e.jsxs("div",{className:"work-detail__meta",children:[e.jsxs("div",{className:"work-detail__meta-row",ref:t=>{w.current[0]=t},children:[e.jsx("span",{className:"work-detail__meta-label",children:"(Year)"}),e.jsx("span",{className:"work-detail__meta-value",children:s.year})]}),e.jsxs("div",{className:"work-detail__meta-row",ref:t=>{w.current[1]=t},children:[e.jsx("span",{className:"work-detail__meta-label",children:"(Timeline)"}),e.jsx("span",{className:"work-detail__meta-value",children:s.timeline})]}),e.jsxs("div",{className:"work-detail__meta-row",ref:t=>{w.current[2]=t},children:[e.jsx("span",{className:"work-detail__meta-label",children:"(Services)"}),e.jsx("span",{className:"work-detail__meta-value",children:fe})]}),s.liveUrl?e.jsxs("a",{className:"work-detail__meta-link",href:s.liveUrl,target:"_blank",rel:"noreferrer",ref:L,children:[e.jsx("span",{className:"work-detail__meta-link-text",children:"Live Website"}),e.jsx("svg",{viewBox:"0 0 14 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"work-detail__meta-link-icon",width:"12","aria-hidden":"true",children:e.jsx("path",{d:"M13.376 11.552l-.264-10.44-10.44-.24.024 2.28 6.96-.048L.2 12.56l1.488 1.488 9.432-9.432-.048 6.912 2.304.024z",fill:"currentColor"})})]}):null]})]}),e.jsxs("div",{className:"work-detail__media",children:[e.jsx("div",{className:"work-detail__hero-media",ref:z,children:e.jsx("img",{src:s.image,srcSet:te||void 0,sizes:te?"(max-width: 900px) 92vw, 70vw":void 0,alt:`${s.title} hero`,width:1600,height:900,decoding:"async"})}),e.jsx("div",{className:"work-detail__grid",children:(re=s.gallery)==null?void 0:re.map((t,r)=>e.jsx("div",{className:"work-detail__tile",ref:c=>{S.current[r]=c},children:e.jsx("img",{src:t,srcSet:Y(G(t),t)||void 0,sizes:"(max-width: 900px) 44vw, 22vw",alt:`${s.title} detail ${r+1}`,width:1200,height:800,loading:"lazy",decoding:"async"})},`${s.id}-gallery-${r}`))})]}),(D||F)&&e.jsxs("div",{className:"work-detail__insights mt-56 xl:mt-80",children:[D&&e.jsxs("div",{className:"work-detail__insight",ref:t=>{j.current[0]=t},children:[e.jsx("p",{className:"work-detail__insight-title",children:"Challenges"}),e.jsx("p",{className:"work-detail__insight-body",children:D})]}),F&&e.jsxs("div",{className:"work-detail__insight",ref:t=>{j.current[ce]=t},children:[e.jsx("p",{className:"work-detail__insight-title",children:"Solutions"}),e.jsx("div",{className:"work-detail__insight-content",children:e.jsx("p",{className:"work-detail__insight-body",children:F})}),O&&e.jsx("div",{className:"work-detail__insight-media-shell",children:e.jsx("div",{className:"work-detail__insight-media",ref:t=>{T.current[0]=t,B.current=t},children:p?e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:m,className:"work-detail__insight-video",src:O,poster:ne,autoPlay:b,loop:le,muted:!0,playsInline:!0,preload:oe,onPlay:()=>M(!0),onPause:()=>M(!1),onLoadedMetadata:ue,onTimeUpdate:me,"aria-label":`${s.title} solution video`}),e.jsxs("div",{className:"work-detail__video-controls",children:[e.jsxs("div",{className:"work-detail__video-time",children:[e.jsx("span",{children:K(H)}),e.jsx("span",{children:K(o)})]}),e.jsx("input",{className:"work-detail__video-progress",type:"range",min:"0",max:o||0,step:"0.1",value:H,onChange:he,onPointerDown:q,onPointerUp:V,onPointerCancel:V,onMouseDown:q,onMouseUp:V,onTouchStart:q,onTouchEnd:V,style:{"--progress":`${pe}%`},"aria-label":"Video progress"})]}),e.jsx("button",{type:"button",className:"work-detail__video-button",onClick:de,"aria-label":f?"Pause video":"Play video","aria-pressed":f,children:f?e.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:[e.jsx("rect",{x:"6.5",y:"5",width:"4.5",height:"14"}),e.jsx("rect",{x:"13",y:"5",width:"4.5",height:"14"})]}):e.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:e.jsx("path",{d:"M8 5.5l10 6.5-10 6.5z"})})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-center",children:[e.jsx("p",{className:"text-sm text-neutral-400",children:"The video loads after you scroll near it or tap to load, saving bandwidth until you are ready."}),e.jsx("button",{type:"button",className:"mt-2 text-xs font-semibold uppercase tracking-[0.2em]",onClick:()=>d(!0),children:"Load preview"})]})})})]})]}),h&&e.jsxs("div",{className:"work-detail__results",children:[e.jsxs("div",{className:"work-detail__results-header",ref:I,children:[e.jsx("p",{className:"work-detail__insight-title",children:"Results"}),e.jsxs("div",{className:"work-detail__results-content",children:[h.summary&&e.jsx("p",{className:"work-detail__results-summary",children:h.summary}),Z.length>0&&e.jsx("div",{className:"work-detail__metrics",children:Z.map((t,r)=>e.jsxs("div",{className:"work-detail__metric",ref:c=>{A.current[r]=c},children:[e.jsx("span",{className:"work-detail__metric-value",children:t.value}),e.jsx("span",{className:"work-detail__metric-label",children:t.label})]},`${s.id}-metric-${r}`))})]})]}),(l==null?void 0:l.quote)&&e.jsx("div",{className:"work-detail__testimonial",ref:W,children:e.jsxs("div",{className:"work-detail__testimonial-card",children:[e.jsx("span",{className:"work-detail__testimonial-mark","aria-hidden":"true",children:"“"}),e.jsx("p",{className:"work-detail__testimonial-body",children:l.quote}),e.jsx("div",{className:"work-detail__testimonial-divider"}),e.jsxs("div",{className:"work-detail__client",children:[l.avatar?e.jsx("img",{className:"work-detail__client-avatar",src:l.avatar,alt:`${l.name} portrait`,loading:"lazy",decoding:"async"}):e.jsx("div",{className:"work-detail__client-avatar work-detail__client-avatar--placeholder",children:ge}),e.jsxs("div",{className:"work-detail__client-meta",children:[e.jsx("p",{className:"work-detail__client-name",children:l.name}),e.jsxs("p",{className:"work-detail__client-role",children:[l.role,l.company?` at ${l.company}`:""]})]})]})]})})]}),ee.length>0&&e.jsxs("div",{className:"work-detail__more",children:[e.jsxs("div",{className:"work-detail__more-header",children:[e.jsx("h2",{className:"work-detail__more-title",ref:U,children:"More Works"}),e.jsxs("a",{className:"work-detail__more-link",href:X("works"),children:[e.jsx("span",{className:"work-detail__more-link-text",children:"See All"}),e.jsx("span",{className:"work-detail__more-link-icon","aria-hidden":"true",children:"↗"})]})]}),e.jsx("div",{className:"work-detail__more-grid",children:ee.map((t,r)=>e.jsxs("a",{className:"work-detail__more-card",href:X(`works/${encodeURIComponent(t.id)}`),ref:c=>{N.current[r]=c},children:[e.jsx("div",{className:"work-detail__more-media",children:e.jsx("img",{src:t.image,srcSet:Y(G(t.image),t.image)||void 0,sizes:"(max-width: 900px) 80vw, 26vw",alt:`${t.title} preview`,width:1400,height:900,loading:"lazy",decoding:"async"})}),e.jsxs("div",{className:"work-detail__more-meta",children:[e.jsx("p",{className:"work-detail__more-name",children:t.title}),e.jsx("p",{className:"work-detail__more-subtitle",children:t.subtitle})]})]},t.id))})]})]})})};export{be as default};
